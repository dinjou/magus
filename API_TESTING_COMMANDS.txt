# MAGUS API Testing Commands

## Replace YOUR_API_KEY_HERE with the API key you generated in Settings â†’ API Keys

### 1. Get Currently Tracking Task
curl -X GET http://localhost:8000/api/tasks/current/ \
  -H "Authorization: Api-Key YOUR_API_KEY_HERE" \
  -H "Content-Type: application/json"

### 2. List Your Task Types
curl -X GET http://localhost:8000/api/task-types/ \
  -H "Authorization: Api-Key YOUR_API_KEY_HERE" \
  -H "Content-Type: application/json"

### 3. Start Tracking a Task
# Replace TASK_TYPE_ID with an actual ID from your task types list
curl -X POST http://localhost:8000/api/tasks/start/ \
  -H "Authorization: Api-Key YOUR_API_KEY_HERE" \
  -H "Content-Type: application/json" \
  -d '{"task_type_id": TASK_TYPE_ID, "notes": "Started via API"}'

### 4. Stop Currently Tracking Task
curl -X POST http://localhost:8000/api/tasks/stop/ \
  -H "Authorization: Api-Key YOUR_API_KEY_HERE" \
  -H "Content-Type: application/json"

### 5. Interrupt Current Task and Start New One
# Replace TASK_TYPE_ID with the new task type to start
curl -X POST http://localhost:8000/api/tasks/interrupt/ \
  -H "Authorization: Api-Key YOUR_API_KEY_HERE" \
  -H "Content-Type: application/json" \
  -d '{"task_type_id": TASK_TYPE_ID, "notes": "Switched via API"}'

### 6. Get Task History
curl -X GET "http://localhost:8000/api/tasks/?page=1" \
  -H "Authorization: Api-Key YOUR_API_KEY_HERE" \
  -H "Content-Type: application/json"

### 7. Get Today's Analytics Summary
curl -X GET http://localhost:8000/api/analytics/summary/ \
  -H "Authorization: Api-Key YOUR_API_KEY_HERE" \
  -H "Content-Type: application/json"

### 8. Get Weekly Breakdown
curl -X GET http://localhost:8000/api/analytics/weekly/ \
  -H "Authorization: Api-Key YOUR_API_KEY_HERE" \
  -H "Content-Type: application/json"

### 9. Download CSV Export
curl -X GET "http://localhost:8000/api/export/download/?start_date=2025-10-01&end_date=2025-10-31" \
  -H "Authorization: Api-Key YOUR_API_KEY_HERE" \
  -o my_export.csv

### 10. Create a New Task Type via API
curl -X POST http://localhost:8000/api/task-types/ \
  -H "Authorization: Api-Key YOUR_API_KEY_HERE" \
  -H "Content-Type: application/json" \
  -d '{"name": "API Test Task", "emoji": "ðŸ¤–", "color": "#FF6B6B", "is_pinned": true}'


## Example Automation Workflow

# 1. Get your task type IDs
TASK_TYPES=$(curl -s -X GET http://localhost:8000/api/task-types/ \
  -H "Authorization: Api-Key YOUR_API_KEY_HERE" \
  -H "Content-Type: application/json")

echo $TASK_TYPES

# 2. Start tracking (use an ID from above)
curl -X POST http://localhost:8000/api/tasks/start/ \
  -H "Authorization: Api-Key YOUR_API_KEY_HERE" \
  -H "Content-Type: application/json" \
  -d '{"task_type_id": 1, "notes": "Automated tracking"}'

# 3. Wait (do your work)
sleep 300  # 5 minutes

# 4. Stop tracking
curl -X POST http://localhost:8000/api/tasks/stop/ \
  -H "Authorization: Api-Key YOUR_API_KEY_HERE" \
  -H "Content-Type: application/json"


## iOS Shortcuts Integration

For iOS Shortcuts, use these endpoints:
- Start: POST /api/tasks/start/
- Stop: POST /api/tasks/stop/
- Current: GET /api/tasks/current/

In Shortcuts app:
1. Add "Get Contents of URL" action
2. Method: POST (for start/stop) or GET (for current)
3. Headers: 
   - Authorization: Api-Key YOUR_KEY
   - Content-Type: application/json
4. Request Body (for start): {"task_type_id": X}


## Testing API Key Validity

curl -X GET http://localhost:8000/api/auth/me/ \
  -H "Authorization: Api-Key YOUR_API_KEY_HERE" \
  -H "Content-Type: application/json"

If this returns your user info, your API key is valid!


## Common Response Formats

### Success Response (Start Task):
{
  "id": 123,
  "task_type": 5,
  "task_type_detail": {
    "id": 5,
    "name": "Deep Work",
    "emoji": "ðŸ’»",
    "color": "#3A8E61"
  },
  "start_time": "2025-10-15T08:00:00Z",
  "end_time": null,
  "duration": 120.5,
  "interrupted": false
}

### Error Response:
{
  "error": "Already tracking a task",
  "current_task_id": 122,
  "current_task_type": "Email"
}

